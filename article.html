<!DOCTYPE html>
<html lang="en">
<head>
    <!--Primary Tags-->
    <title>Manuscript | Whallop & Co.</title>
    <meta name="title" content="Manuscript | Whallop & Co.">
    <meta name="description" content="Manuscript from the Whallop & Co. Archive">
    <link rel="icon" type="image/png" href="images/favicon.png">
    
    <!--Open Graph Tags-->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://whallopco.github.io/WhallopCo/article">
    <meta property="og:title" content="Manuscript | Whallop & Co.">
    <meta property="og:description" content="Manuscript from the Whallop & Co. Archive.">
    <meta property="og:image" content= "https://raw.githubusercontent.com/WhallopCo/WhallopCo/refs/heads/main/images/Media-Card-Midnight.png">

    <!-- X (Twitter) Tags-->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://whallopco.github.io/WhallopCo/article">
    <meta property="twitter:title" content="Manuscript | Whallop & Co.">
    <meta property="twitter:description" content="Manuscript from the Whallop & Co. Archive.">
    <meta property="twitter:image" content="https://raw.githubusercontent.com/WhallopCo/WhallopCo/refs/heads/main/images/Media-Card-Midnight.png">

    <!--Page specs-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Lora:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="midnight-mode">

<nav>
  <a href="index.html" class="logo">WHALLOP & CO.</a>
  <div class="nav-links">
    <a href="index.html">Back to Archive</a>
    <button id="theme-toggle" onclick="toggleTheme()">Switch Mode</button>
  </div>
</nav>

<div class="feed" id="article-content" style="margin-top: 50px;">
  </div>

<footer>
  <div class="footer-left">© 2026 WHALLOP & CO.</div>
  <div class="footer-right">
    <a href="stocksummary.html">STOCK DRAFT</a>
    <a href="contact.html">CONTACT</a>
    <a href="transcribe.html">TOOL</a>
  </div>
</footer>

<script src="js/theme.js"></script>
<script>
async function loadSingleArticle() {
  const params = new URLSearchParams(window.location.search);
  const articleId = params.get('id');

  const response = await fetch('data/content.json');
  const works = await response.json();
  
  // Find the work by the URL ID
  const work = works.find(w => w.title.replace(/\s+/g, '-').toLowerCase() === articleId);

  if (work) {
    document.title = `${work.title} | Whallop & Co.`;
    const container = document.getElementById('article-content');
    
    let displayContent = "";

    // Check if the content is a path to a PDF
    if (work.content.endsWith('.pdf')) {
      // Add parameters to the URL to hide the native UI as much as possible
      const pdfUrl = `${work.content}#view=FitH&toolbar=0&navpanes=0`;
      displayContent = `
        <div class="pdf-container">
          <iframe src="${pdfUrl}" type="application/pdf" width="100%" height="100%"></iframe>
          <div class="pdf-fallback-link">
            <a href="${work.content}" target="_blank" class="btn-read">Open PDF in New Tab</a>
          </div>
        </div>`;
    } else {
      // Standard text/HTML rendering
      // FIX: Replace the literal \n strings with real HTML line breaks
      const formattedContent = work.content.replace(/\\n/g, '<br>');
  
      displayContent = work.type === 'poem' 
        ? `<div class="poetry-block">${formattedContent}</div>`
        : `<div class="essay-body">${formattedContent}</div>`;
    }

    container.innerHTML = `
      <span class="metadata">${work.date} • ${work.category.toUpperCase()}</span>
      <h1>${work.title}</h1>
      <div class="byline">By ${work.author}</div>
      ${displayContent}
    `;
  }
  else {
    // NEW: The fallback
    document.title = "Not Found | Whallop & Co.";
    document.getElementById('article-content').innerHTML = `
      <div style="text-align: center; margin-top: 100px;">
        <h2>Manuscript Not Found</h2>
        <p class="excerpt">The requested document could not be located in the archive.</p>
        <a href="index.html" class="btn-read" style="margin-top: 20px;">Return to Archive</a>
      </div>
    `;
  }
}

  loadSingleArticle();
</script>
</body>
</html>